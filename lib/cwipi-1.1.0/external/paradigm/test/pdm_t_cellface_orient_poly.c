#include <math.h>
#include <sys/time.h>
#include <time.h>
#include <sys/resource.h>
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <assert.h>

#include <pdm_mpi.h>

#include "pdm.h"
#include "pdm_priv.h"
#include "pdm_part.h"
#include "pdm_cellface_orient.h"

#include "pdm_printf.h"
#include "pdm_error.h"

/*============================================================================
 * Type definitions
 *============================================================================*/

/*============================================================================
 * Private function definitions
 *============================================================================*/

/**
 *
 * \brief  Main
 *
 */

int main(int argc, char *argv[])
{

  /*
   *  Init
   */

  int i_rank;
  int numProcs;

  PDM_MPI_Init(&argc, &argv);
  PDM_MPI_Comm_rank(PDM_MPI_COMM_WORLD, &i_rank);
  PDM_MPI_Comm_size(PDM_MPI_COMM_WORLD, &numProcs);

  const int      n_cell = 3;
  const int      n_face = 42;
  const int      n_vtx  = 36;
  double   vtx[108] = {0.,  0.,  0.,  2.,  0.,  0.,  4.,  0.,  0.,  6.,  0.,  0.,
                       0.,  2.,  0.,  2.,  2.,  0.,  4.,  2.,  0.,  6.,  2.,  0.,
                       0.,  4.,  0.,  2.,  4.,  0.,  4.,  4.,  0.,  6.,  4.,  0.,
                       0.,  0.,  2.,  2.,  0.,  2.,  4.,  0.,  2.,  6.,  0.,  2.,
                       0.,  2.,  2.,  2.,  2.,  2.,  4.,  2.,  2.,  6.,  2.,  2.,
                       0.,  4.,  2.,  2.,  4.,  2.,  4.,  4.,  2.,  6.,  4.,  2.,
                       0.,  0.,  4.,  2.,  0.,  4.,  4.,  0.,  4.,  6.,  0.,  4.,
                       0.,  2.,  4.,  2.,  2.,  4.,  4.,  2.,  4.,  6.,  2.,  4.,
                       0.,  4.,  4.,  2.,  4.,  4.,  4.,  4.,  4.,  6.,  4.,  4.};

  int  cell_face_idx[4] = {0, 18, 36, 52};
  int  cell_face[52] = {  1,  2,  6,  7,  9, 10, 12, 15, 21, 24,
                        26, 27, 29, 35, 36, 37, 40, 41,
                         4,  5, 10, 11, 15, 16, 17, 18, 19, 20,
                        25, 28, 32, 33, 34, 35, 36, 42,
                         2,  3,  7,  8, 13, 14, 16, 17, 22, 23, 24, 25, 30, 31,
                        38, 39};

  int  *face_cell = NULL;

  int face_vtx_idx[43] = { 0,  4,  8, 12, 16, 20, 24, 28, 32, 36, 40,
                         44, 48, 52, 56, 60, 64, 68, 72, 76,  80,  84,
                         88,  92,  96, 100, 104, 108, 112, 116, 120,
                         124, 128, 132, 136, 140, 144, 148, 152, 156,
                         160, 164, 168};

  int face_vtx[168] = {13, 17,  5,  1,  2,  6, 18, 14,  4,  8,
                      20, 16, 17, 21,  9,  5,  8, 12, 24, 20,
                      25, 29, 17, 13, 14, 18, 30, 26, 16, 20,
                      32, 28, 29, 33, 21, 17, 19, 23, 35, 31,
                      20, 24, 36, 32,  1,  2, 14, 13,  2,  3,
                      15, 14,  3,  4, 16, 15,  5,  6, 18, 17,
                      6,  7, 19, 18,  7,  8, 20, 19, 21, 22,
                      10,  9, 22, 23, 11, 10, 23, 24, 12, 11,
                      13, 14, 26, 25, 14, 15, 27, 26, 15, 16,
                      28, 27, 18, 19, 31, 30, 19, 20, 32, 31,
                      33, 34, 22, 21, 34, 35, 23, 22, 35, 36,
                      24, 23,  5,  6,  2,  1,  6,  7,  3,  2,
                      7,  8,  4,  3,  9, 10,  6,  5, 10, 11,
                      7,  6, 11, 12,  8,  7, 17, 18, 22, 21,
                      18, 19, 23, 22, 25, 26, 30, 29, 26, 27,
                      31, 30, 27, 28, 32, 31, 29, 30, 34, 33,
                      30, 31, 35, 34, 31, 32, 36, 35};

  PDM_cellface_orient (n_cell,
                       n_face,
                       n_vtx,
                       vtx,
                       cell_face_idx,
                       cell_face,
                       face_cell,
                       face_vtx_idx,
                       face_vtx);

  PDM_MPI_Finalize();

  return 0;
}
